■HCMasterの月1取込 for OTLチェックシート
　・どのシステムのための取込か
　コンサル統合メニュー＞OTLチェックシート
   HR情報は、HCMasterをマスターとしている
　 時間データは、DailyでPAから取込んでいるUtlzのバッチで取込まれる

　・DB構成
　画面で使用しているDBテーブルは、UTLZ_EMP_ORG(組織)と、UTLZ_EMP_DAY_CC_TASK_HRS(時間)。
　HCMasterの取込先は、このUTLZ_EMP_ORG。
　エクセルマクロでは、まずUTLZ_EMP_ORG_XXXにエクセルのデータを入れて、
　プロシージャを実行して、UTLZ_EMP_ORGに反映している
　プロシージャは多分utlz_sv

・フロー
　1.山田(晃一郎)さんから月初-月中にメールでHCMasterと異動連絡票が送られてくる
　2.当月の業務委託社員データを取得している
　上記2つがそろったら作業する

・取込手順
1．テスト環境DBに本番データを入れる
/home/ocsjsys/.scripts/
./synchro_data_HCMaster.sh

2．ファイルのデータ成形
・業務委託社員データ(従業員取り込みで作成したyyyy_Mon.xlsxのこと)
　1.Hr Organization Codeの列を、40000000を入力

　2.保存する。

・HCMaster
　1.Statusの列の値がActive以外の行を削除
　2.Level1が「オペレーションズ統括」の行を削除
　3.Statusの列を削除
　4.Nameの列をL列に移動(M列を選択して列を挿入)
　5.Level3が「コンサルティングサービス事業統括」の行はLevel3、Level4、Level5の値をDelete
  　(L4,L5は白文字で見えないが値あり)
　6.右と比べて同じ文字列なら右を削除
　7.保存する

3．開発環境に取込
・業務委託社員データ取込
　エクセルを開いて、同じWindowに、テスト用ツール(test_utlz_emp_org_contractor.xls)と業務委託社員データを開く
　業務委託社員データが表に出ている状態でエクセルマクロのexec_allを実行、パラメータは取込みたいシート名とする
　⇒　処理完了と出る
　　(マクロでは、utlz_emp_org_xxxデータを削除し、エクセルのデータを入れるということをしている)


・正社員データ取込
　エクセルを開いて、同じWindowに、テスト用ツール(test_utlz_emp_org.xls)とHCMasterを開く
　エクセルマクロのexec_allを実行、パラメータは取込みたいシート名とする
　⇒　正常完了と出る　組織がどうののエラーが出た場合は、エクセルに載っている組織がORG_LISTにない場合があるので確認する
　　(マクロでは、エクセルデータをutlz_emp_org_xxxに入れ、プロシージャを起動(utlz_emp_org_xxxデータをutlz_emp_orgに反映する)ということをしている)

データ確認
　マクロに載っているSQLを実行して異動連絡票と見比べて正しいか確認
※異動連絡表で確認するのは正社員データのみ！
※異動連絡表に載っていない場合、コンサル統合メニューのOTLチェックシートから、
　前の所属が何だったか確認する
　(大きい異動なら異動連絡表に載るけど、小さい異動は異動連絡表に載らない場合もある)
　異動連絡表に載っていなくて正社員の場合は、山田さんに一声かけて確認してみるとよい。
　正社員かどうか悩んだ時は、HCmasterに載っているか確認する


4．本番に取込む
業務委託社員データ取込
　エクセルを開いて、同じWindowに、本番用ツール(utlz_emp_org_contractor.xls)と業務委託社員データを開く
　エクセルマクロのexec_allを実行、パラメータは取込みたいシート名とする
　⇒　処理完了と出る
　　(マクロでは、utlz_emp_org_xxxデータを削除し、エクセルのデータを入れるということをしている)
正社員データ取込
　エクセルを開いて、同じWindowに、本番用ツール(utlz_emp_org.xls)とHCMasterを開く
　エクセルマクロのexec_allを実行、パラメータは取込みたいシート名とする
　⇒　正常完了と出る　組織がどうののエラーが出た場合は、エクセルに載っている組織がORG_LISTにない場合があるので確認する
　　(マクロでは、エクセルデータをutlz_emp_org_xxxに入れ、プロシージャを起動(utlz_emp_org_xxxデータをutlz_emp_orgに反映する)ということをしている)
データ確認
　マクロに載っているSQLを実行して異動連絡票と見比べて正しいか確認

報告は不必要

以上

